// prisma/schema.prisma

generator client {
  provider = "prisma-client"
  output   = "../src/infrastructure/database/generated/prisma"
}

datasource db {
  provider = "mysql"
}

// Inbox Event Pattern for processing RabbitMQ events
model InboxEvent {
  id          Int              @id @default(autoincrement())
  queue       String
  serviceName String
  status      InboxEventStatus @default(PENDING)
  handledAt   DateTime?
  payload     Json
  createdAt   DateTime         @default(now())
  updatedAt   DateTime         @updatedAt
}

enum InboxEventStatus {
  PENDING
  Handled
}

// Email logs for tracking sent emails
model EmailLog {
  id        Int         @id @default(autoincrement())
  to        String
  subject   String
  body      Json
  status    EmailStatus @default(PENDING)
  messageId String? // ID returned by email provider
  error     String? // Error message if sending failed
  createdAt DateTime    @default(now())
  updatedAt DateTime    @updatedAt
}

enum EmailStatus {
  PENDING
  SENT
  FAILED
}

enum EmailTypes {
  Verification
}
